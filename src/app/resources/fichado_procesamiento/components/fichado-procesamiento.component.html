<div class="flex flex-col flex-auto min-w-0 w-full h-full bg-gray-50 dark:bg-gray-900">

    <mat-card class="w-full bg-card shadow-none rounded-none overflow-hidden">
        <div class="px-6 py-4">
            
            <fwk-file-uploader
                [accept]="'.xlsx, .xls'"
                [title]="'FICHADO_PROCESAMIENTO_CARGA_SECTION_SELECT_EXCEL' | translate:i18nName"
                [description]="'Arrastra tu archivo aquÃ­ o haz click para buscar en tu equipo (.xlsx, .xls)'"
                [icon]="'heroicons_outline:cloud-arrow-up'"
                [isLoading]="isProcessingExcel"
                [loadingText]="'FICHADO_PROCESAMIENTO_PROCESANDO' | translate:i18nName"
                (fileSelected)="onFileSelected($event)">
            </fwk-file-uploader>

        </div>
    </mat-card>

    <div class="flex-auto border border-t overflow-hidden" *ngIf="isProcessed">
        <div class="overflow-x-auto">
            <table mat-table [dataSource]="dataSource" multiTemplateDataRows class="w-full bg-transparent">
                <ng-container matColumnDef="legajo">
                    <th mat-header-cell *matHeaderCellDef class="bg-gray-50/80 dark:bg-gray-800 text-sm">
                        {{ 'FICHADO_PROCESAMIENTO_TABLE_EMPLEADO_LEGAJO' | translate:i18nName }}
                    </th>
                    <td mat-cell *matCellDef="let element" class="px-6 py-4 font-mono text-sm">
                        {{element.legajo}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="nombreCompleto">
                    <th mat-header-cell *matHeaderCellDef class="bg-gray-50/80 dark:bg-gray-800 text-sm">
                        {{ 'FICHADO_PROCESAMIENTO_TABLE_EMPLEADO_NOMBRE_COMPLETO' | translate:i18nName }}
                    </th>
                    <td mat-cell *matCellDef="let element" class="px-6 py-4 font-medium">
                        {{element.nombreCompleto}}
                    </td>
                </ng-container>

                <ng-container matColumnDef="expand">
                    <th mat-header-cell *matHeaderCellDef class="w-10 bg-gray-50/80 dark:bg-gray-800 text-sm"> </th>
                    <td mat-cell *matCellDef="let element" class="px-2 text-center">
                        <button mat-icon-button (click)="expandRow(element); $event.stopPropagation()">
                            <mat-icon
                                [svgIcon]="expandedElement === element ? 'heroicons_solid:chevron-up' : 'heroicons_solid:chevron-down'"></mat-icon>
                        </button>
                    </td>
                </ng-container>

                <ng-container matColumnDef="expandedDetail">
                    <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplayWithExpand.length"
                        class="p-0 border-0">
                        <div class="overflow-hidden dark:bg-gray-900 border-t border-b border-gray-200 dark:border-gray-700"
                            [@detailExpand]="element === expandedElement ? 'expanded' : 'collapsed'">

                            <div class="overflow-x-auto">
                                <table mat-table [dataSource]="element.fichados"
                                    class="w-full bg-transparent inner-table">

                                    <ng-container matColumnDef="dia">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_DIA' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.dia}}</td>
                                    </ng-container>

                                    <ng-container matColumnDef="fecha">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_FECHA' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm whitespace-nowrap">
                                            {{fichado.fecha}}</td>
                                    </ng-container>

                                    <ng-container matColumnDef="entrada1">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_ENTRADA1' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.entrada1}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="salida1">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_SALIDA1' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.salida1}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="entrada2">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_ENTRADA2' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.entrada2}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="salida2">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_SALIDA2' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.salida2}}</td>
                                    </ng-container>

                                    <ng-container matColumnDef="totalDia">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase bg-primary-50/50 dark:bg-primary-900/10">
                                            {{ 'FICHADO_PROCESAMIENTO_TABLE_DETALLE_TOTAL_DIA' | translate:i18nName }}
                                        </th>
                                        <td mat-cell *matCellDef="let fichado"
                                            class="text-sm font-medium bg-primary-50/50 dark:bg-primary-900/10">
                                            {{fichado.totalDia}}</td>
                                    </ng-container>

                                    <ng-container matColumnDef="descanso">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_DESCANSO' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.descanso}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="normal">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_NORMAL' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.normal}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="extra50">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_EXTRA50' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.extra50}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="extra100">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_EXTRA100' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm">{{fichado.extra100}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="tarde">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_TARDE' | translate:i18nName }}</th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm text-red-500 font-medium">
                                            {{fichado.tarde}}</td>
                                    </ng-container>
                                    <ng-container matColumnDef="comentarios">
                                        <th mat-header-cell *matHeaderCellDef
                                            class="text-xs font-semibold text-secondary uppercase min-w-[200px]">{{
                                            'FICHADO_PROCESAMIENTO_TABLE_DETALLE_COMENTARIOS' | translate:i18nName }}
                                        </th>
                                        <td mat-cell *matCellDef="let fichado" class="text-sm italic text-secondary">
                                            {{fichado.comentarios}}</td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="fichadosDisplayedColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: fichadosDisplayedColumns;"
                                        class="bg-white dark:bg-gray-900 hover:bg-gray-100 dark:hover:bg-gray-800"></tr>
                                </table>
                            </div>
                        </div>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
                <tr mat-row *matRowDef="let element; columns: columnsToDisplayWithExpand;"
                    class="element-row cursor-pointer bg-white dark:bg-gray-900 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors"
                    [class.bg-gray-50]="expandedElement === element"
                    [class.dark:bg-gray-800]="expandedElement === element" (click)="expandRow(element)">
                </tr>
                <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="h-0"></tr>
            </table>
        </div>
    </div>
</div>